
 RUN  v4.0.16 /private/tmp/time-control-hub

stdout | tests/cycle16_credential_rotation.test.ts
[dotenv@17.2.3] injecting env (0) from .env -- tip: ğŸ” prevent committing .env to code: https://dotenvx.com/precommit

stderr | tests/cycle16_credential_rotation.test.ts
âš ï¸ SUPABASE_SERVICE_ROLE_KEY not set. Integration tests requiring admin access will fail.

stdout | tests/cycle16_credential_rotation.test.ts
[dotenv@17.2.3] injecting env (0) from .env -- tip: âš™ï¸  enable debug logging with { debug: true }

 â¯ tests/cycle16_credential_rotation.test.ts (2 tests | 1 failed) 3048ms
     âœ“ should maintain a tracked inventory of exposed credentials to revoke 1ms
     Ã— all known exposed credentials should be revoked (no successful sign-in) 3046ms

â¯â¯â¯â¯â¯â¯â¯ Failed Tests 1 â¯â¯â¯â¯â¯â¯â¯

 FAIL  tests/cycle16_credential_rotation.test.ts > Cycle 16: Live revocation probe > all known exposed credentials should be revoked (no successful sign-in)
AssertionError: expected [ { â€¦(2) }, { â€¦(2) }, { â€¦(2) }, â€¦(7) ] to deeply equal []

- Expected
+ Received

- []
+ [
+   {
+     "email": "superadmin@timecontrol.com",
+     "label": "super_admin_default",
+   },
+   {
+     "email": "admin@elrincon.com",
+     "label": "admin_elrincon_default",
+   },
+   {
+     "email": "admin@zapateria-lopez.com",
+     "label": "admin_zapateria_default",
+   },
+   {
+     "email": "admin@dentalsonrisas.com",
+     "label": "admin_dental_default",
+   },
+   {
+     "email": "admin@fisio-wellness.com",
+     "label": "admin_fisio_default",
+   },
+   {
+     "email": "responsable@elrincon.com",
+     "label": "responsable_elrincon_default",
+   },
+   {
+     "email": "juan.martinez@elrincon.com",
+     "label": "employee_elrincon_default",
+   },
+   {
+     "email": "admin@test.com",
+     "label": "fixture_admin_default",
+   },
+   {
+     "email": "carlos.garcia@empresa.com",
+     "label": "fixture_employee_default",
+   },
+   {
+     "email": "asesor@laboralconsulting.com",
+     "label": "asesor_default",
+   },
+ ]

 â¯ tests/cycle16_credential_rotation.test.ts:121:31
    119|     }
    120| 
    121|     expect(activeCredentials).toEqual([]);
       |                               ^
    122|   }, 60_000);
    123| });

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/1]â¯


 Test Files  1 failed (1)
      Tests  1 failed | 1 passed (2)
   Start at  19:26:59
   Duration  3.55s (transform 28ms, setup 51ms, import 25ms, tests 3.05s, environment 320ms)

